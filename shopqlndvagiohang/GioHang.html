<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qu·∫£n L√Ω Gi·ªè H√†ng</title>
  <link rel="icon" type="image/jpg" href="logo160s.jpg">
  <link rel="stylesheet" href="style_qlnd.css">
</head>
<body>
  <div class="container">
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="admin-info">
        <img src="·∫£nh ƒë·∫°i di·ªán trang ch·ªß..jpg" alt="Admin">
        <h3>Qu·∫£n tr·ªã vi√™n</h3>
      </div>
      <nav>
        <a href="QLND.HTML">üë• Qu·∫£n l√Ω ng∆∞·ªùi d√πng</a>
        <a href="GioHang.HTML" class="active">üõí Gi·ªè h√†ng</a>
        <a href="GioHangChiTiet.HTML">üì¶ Gi·ªè h√†ng chi ti·∫øt</a>
      </nav>
    </div>

    <!-- N·ªôi dung ch√≠nh -->
    <main class="content">
      <h1>Qu·∫£n L√Ω Gi·ªè H√†ng</h1>

      <div class="actions">
        <button class="btn-add" id="btnAddCart">‚ûï Th√™m gi·ªè h√†ng</button>
        <div class="search">
          <input type="search" id="searchCart" placeholder="T√¨m ki·∫øm gi·ªè h√†ng...">
          <button id="btnSearchCart">üîç</button>
        </div>
      </div>

      <div class="user-table">
        <table id="cartTable">
          <thead>
            <tr>
              <th>ID Gi·ªè</th>
              <th>ID Ng∆∞·ªùi D√πng</th>
              <th>Ng√†y T·∫°o</th>
              <th>Thao T√°c</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </main>
  </div>

  <!-- Modal th√™m -->
  <div class="modal" id="cartModal">
    <div class="modal-content">
      <h2>Th√™m Gi·ªè H√†ng</h2>
      <input type="number" id="idND" placeholder="ID Ng∆∞·ªùi D√πng">
      <div class="modal-buttons">
        <button class="btn-save" id="saveCart">L∆∞u</button>
        <button class="btn-cancel" id="cancelCart">H·ªßy</button>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    let carts = JSON.parse(localStorage.getItem("carts")) || [];

    const tableBody = document.querySelector("#cartTable tbody");
    const modal = document.getElementById("cartModal");
    const saveBtn = document.getElementById("saveCart");
    const cancelBtn = document.getElementById("cancelCart");
    const addBtn = document.getElementById("btnAddCart");
    const searchInput = document.getElementById("searchCart");

    function render(data) {
      tableBody.innerHTML = "";
      if (data.length === 0) {
        tableBody.innerHTML = `<tr><td colspan="4" style="text-align:center;">Ch∆∞a c√≥ gi·ªè h√†ng n√†o</td></tr>`;
        return;
      }
      data.forEach(c => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${c.id_GH}</td>
          <td>${c.id_ND}</td>
          <td>${c.ngay_Tao}</td>
          <td>
            <button class="btn-edit" onclick="viewDetail(${c.id_GH})">üì¶ Chi ti·∫øt</button>
            <button class="btn-delete" onclick="deleteCart(${c.id_GH})">‚ùå</button>
          </td>`;
        tableBody.appendChild(tr);
      });
    }

    function deleteCart(id) {
      if (confirm("X√≥a gi·ªè h√†ng n√†y?")) {
        carts = carts.filter(c => c.id_GH !== id);
        localStorage.setItem("carts", JSON.stringify(carts));
        render(carts);
      }
    }

    function viewDetail(id) {
      localStorage.setItem("currentCart", id);
      window.location.href = "GioHangChiTiet.HTML";
    }

    addBtn.onclick = () => {
      modal.classList.add("active");
      document.getElementById("idND").value = "";
    };

    cancelBtn.onclick = () => modal.classList.remove("active");

    saveBtn.onclick = () => {
      const idND = document.getElementById("idND").value.trim();
      if (!idND) return alert("Nh·∫≠p ID ng∆∞·ªùi d√πng!");
      const newCart = {
        id_GH: carts.length ? Math.max(...carts.map(c => c.id_GH)) + 1 : 1,
        id_ND: idND,
        ngay_Tao: new Date().toLocaleString()
      };
      carts.push(newCart);
      localStorage.setItem("carts", JSON.stringify(carts));
      modal.classList.remove("active");
      render(carts);
    };

    searchInput.addEventListener("input", e => {
      const keyword = e.target.value.toLowerCase();
      const filtered = carts.filter(c =>
        c.id_ND.toString().includes(keyword) ||
        c.id_GH.toString().includes(keyword)
      );
      render(filtered);
    });

    render(carts);
  </script>
</body>
</html>
