<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Giỏ Hàng - 160STORE</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css">
  <style>
    body {
      background: linear-gradient(135deg, #0a0c15 0%, #0f0519 100%);
      min-height: 100vh;
    }
    .cart-container {
      background: #fff;
      border-radius: 16px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.08);
      max-width: 900px;
      margin: 40px auto;
      padding: 32px 24px;
    }
    @media (max-width: 600px) {
      .cart-container {
        padding: 16px 4px;
      }
      .cart-table th, .cart-table td {
        font-size: 13px;
        padding: 6px 2px;
      }
    }
  </style>
</head>
<body>
  <div class="cart-container">
    <h2 class="text-2xl font-bold mb-6 text-center text-gray-800">Giỏ Hàng Của Bạn</h2>
    <div id="empty-cart" class="text-center text-gray-500 my-8 hidden">
      <i class="fas fa-shopping-cart text-4xl mb-2"></i>
      <p>Giỏ hàng của bạn đang trống.</p>
      <a href="TrangChu.html" class="text-blue-600 hover:underline">Tiếp tục mua sắm</a>
    </div>
    <div id="cart-table-wrap">
      <table class="cart-table w-full border-collapse mb-6">
        <thead>
          <tr class="bg-gray-100">
            <th class="p-3">Ảnh</th>
            <th class="p-3">Tên sản phẩm</th>
            <th class="p-3">Giá</th>
            <th class="p-3">Số lượng</th>
            <th class="p-3">Thành tiền</th>
            <th class="p-3">Xóa</th>
          </tr>
        </thead>
        <tbody id="cart-body"></tbody>
      </table>
      <div class="flex justify-end items-center">
        <span class="font-semibold text-lg mr-4">Tổng cộng:</span>
        <span id="cart-total" class="text-xl font-bold text-green-600">0đ</span>
      </div>
      <div class="flex justify-end mt-6">
        <a href="ThanhToan.html" class="bg-blue-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-blue-700 transition">Thanh toán</a>
      </div>
    </div>
  </div>

  <script>
    // Lấy giỏ hàng từ localStorage
    function getCart() {
      return JSON.parse(localStorage.getItem('cart')) || [];
    }
    function saveCart(cart) {
      localStorage.setItem('cart', JSON.stringify(cart));
    }
    function formatPrice(price) {
      return price.toLocaleString('vi-VN') + 'đ';
    }
    function renderCart() {
      const cart = getCart();
      const tbody = document.getElementById('cart-body');
      const totalSpan = document.getElementById('cart-total');
      const emptyCart = document.getElementById('empty-cart');
      const cartTableWrap = document.getElementById('cart-table-wrap');
      tbody.innerHTML = '';
      let total = 0;
      if (cart.length === 0) {
        emptyCart.classList.remove('hidden');
        cartTableWrap.style.display = 'none';
        return;
      } else {
        emptyCart.classList.add('hidden');
        cartTableWrap.style.display = '';
      }
      cart.forEach((item, idx) => {
        const itemTotal = item.price * item.quantity;
        total += itemTotal;
        tbody.innerHTML += `
          <tr>
            <td class="p-2 text-center"><img src="${item.img}" width="60" class="rounded shadow"></td>
            <td class="p-2">${item.name}</td>
            <td class="p-2 text-green-700 font-semibold">${formatPrice(item.price)}</td>
            <td class="p-2 text-center">
              <button onclick="changeQty(${idx}, -1)" class="px-2 py-1 bg-gray-200 rounded hover:bg-gray-300">-</button>
              <span class="mx-2">${item.quantity}</span>
              <button onclick="changeQty(${idx}, 1)" class="px-2 py-1 bg-gray-200 rounded hover:bg-gray-300">+</button>
            </td>
            <td class="p-2 text-right font-bold">${formatPrice(itemTotal)}</td>
            <td class="p-2 text-center">
              <button onclick="removeCartItem(${idx})" class="text-red-600 hover:underline">Xóa</button>
            </td>
          </tr>
        `;
      });
      totalSpan.textContent = formatPrice(total);
    }
    function removeCartItem(idx) {
      let cart = getCart();
      cart.splice(idx, 1);
      saveCart(cart);
      renderCart();
    }
    function changeQty(idx, delta) {
      let cart = getCart();
      cart[idx].quantity += delta;
      if (cart[idx].quantity < 1) cart[idx].quantity = 1;
      saveCart(cart);
      renderCart();
    }
    window.onload = renderCart;
  </script>
  <script src="https://kit.fontawesome.com/2c36e9b7b1.js" crossorigin="anonymous"></script>
</body>
</html>